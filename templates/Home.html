<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Detection - Takluban Profane Detector</title>
    <link rel="icon" href="{{ url_for('static', filename='assets/tklbn-favicon.png') }}" type="image/png">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='style/Home.css') }}">
</head>

<body>
    <!-- Loader section with video -->
    <div id="loader">
        <video autoplay muted loop id="loadingVideo">
            <source src="{{ url_for('static', filename='assets/tklbn-loading.mp4') }}" type="video/mp4">
        </video>
    </div>

    <!-- Main landing page content -->
    <div id="landingPage" style="display: none;">
        <nav>
            <div class="logo">
                <img src="{{ url_for('static', filename='assets/tklbn-logo.png') }}" alt="Takluban Logo">
            </div>
            <span class="title">FILIPINO NATIVE LANGUAGE PROFANE DETECTION</span>
            <div class="nav-links">
                <a href="{{ url_for('home') }}" class="home-link active">HOME</a>
                <a href="{{ url_for('creators') }}" class="creators-link">ABOUT US</a>
                <a href="{{ url_for('faqs') }}" class="faqs-link">FAQs</a>
            </div>
        </nav>

        <div class="container">
            <div class="left">
                <textarea id="text-area" placeholder="Input text here to detect profanity and language."></textarea>
                <div class="detect-button-container">
                    <button class="detect-button">DETECT</button>
                </div>
            </div>
            <div class="right">
                <div class="module">
                    <div class="module-title">DETECTED LANGUAGE:</div>
                    <div id="detected-language"></div>
                </div>
                <div class="module">
                    <div class="module-title">POS TAGGED SENTENCE:</div>
                    <div id="pos-tagged-sentence"></div>
                </div>
                <div class="module">
                    <div class="module-title">CENSORED OR CLEAN SENTENCE:</div>
                    <div id="censored-sentence"></div>
                </div>
                <div class="module">
                    <div class="module-title">PROFANITY STATUS:</div>
                    <div id="profanity-status"></div>
                </div>
            </div>
        </div>

        <footer>
            <img src="{{ url_for('static', filename='assets/tklbn-favicon.png') }}" alt="Footer Icon">
            <p>All Rights Reserved, 2024</p>
        </footer>
    </div>

    <script>
        // Show loader on page load, then display the landing page
        window.onload = function() {
            if (sessionStorage.getItem('visited')) {
                document.getElementById('loader').style.display = 'none';
                document.getElementById('landingPage').style.display = 'block';
            } else {
                setTimeout(function() {
                    document.getElementById('loader').style.display = 'none';
                    document.getElementById('landingPage').style.display = 'block';
                    sessionStorage.setItem('visited', 'true');
                }, 5900);
            }
        };

        // Detect button functionality (connecting with backend)
        document.querySelector('.detect-button').addEventListener('click', function() {
            const text = document.getElementById('text-area').value;

            fetch('/detect_language', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/x-www-form-urlencoded',
                },
                body: `text=${encodeURIComponent(text)}`
            })
            .then(response => response.json())
            .then(data => {
                // Module 1: Detected language
                document.getElementById('detected-language').innerText = data.predicted_language || 'Error detecting language';

                // Module 2: POS tagged sentence
                document.getElementById('pos-tagged-sentence').innerText = data.pos_tagged || 'Error processing the sentence.';

                // Module 3: Censored or clean sentence
                document.getElementById('censored-sentence').innerText = data.censored_sentence || 'Error processing the sentence.';

                // Module 4: Profanity status
                document.getElementById('profanity-status').innerText = data.is_profane ? 'Profane' : 'Not Profane';
            })
            .catch(error => {
                console.error('Error:', error);
                document.getElementById('detected-language').innerText = 'Error detecting language';
                document.getElementById('pos-tagged-sentence').innerText = 'Error processing the sentence.';
                document.getElementById('censored-sentence').innerText = 'Error processing the sentence.';
                document.getElementById('profanity-status').innerText = 'Error detecting profanity.';
            });
        });
    </script>
</body>
</html>
