<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Takluban Profane Detector</title>
    <link rel="icon" href="../WEB/assets/tklbn-favicon.png" type="image/png">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../static/style/Home.css">
</head>

<nav>
    <div class="logo">
        <img src="../WEB/assets/tklbn-logo.png" alt="Takluban Logo">
    </div>
    <span class="title">FILIPINO NATIVE LANGUAGE PROFANE DETECTION</span> 
    <div class="nav-links">
        <a href="{{ url_for('home') }}" class="home-link active">HOME</a>
        <a href="{{ url_for('creators') }}" class="creators-link">ABOUT US</a>
        <a href="{{ url_for('faqs') }}" class="faqs-link">FAQs</a>        
    </div> <!-- Navigation Links -->
</nav>

<body>
    <div class="container">
        <div class="left">
            <textarea id="text-area" placeholder="To detect profanities, input text here and click 'DETECT'."></textarea>
            <div class="detect-button-container">
                <button class="detect-button">DETECT</button>
            </div>
        </div>
        <div class="right">
            <div class="module module-1">
                <div class="module-title">FILIPINO NATIVE LANGUAGE IDENTIFIED</div>
                <div id="detected-language"></div> 
            </div>
            <div class="module module-2">
                <div class="module-title">POS TAGGED SENTENCE</div>
                <div id="pos-tagged-sentence"></div> <!-- POS tagged sentence will appear here -->
            </div>
        </div>
    </div>

    <footer>
        <img src="../WEB/assets/tklbn-favicon.png" alt="Footer Icon"> 
        <p>All Rights Reserved, 2024</p>
    </footer>

    <script>
        // Original script for word count and instructions
        const textArea = document.getElementById('text-area');
        const instruction = document.getElementById('instruction');
        const maxWords = 10;
        const wordsLeftDisplay = document.createElement('div');
        wordsLeftDisplay.id = 'words-left';
        wordsLeftDisplay.textContent = `Allowed number of words remaining: ${maxWords}`;
        textArea.parentNode.insertBefore(wordsLeftDisplay, textArea.nextSibling);
    
        textArea.addEventListener('focus', function() {
            instruction.style.display = 'none'; 
        });
    
        textArea.addEventListener('blur', function() {
            if (textArea.value === '') {
                instruction.style.display = 'block'; 
            }
        });
    
        textArea.addEventListener('input', function() {
            const words = textArea.value.split(/\s+/).filter(word => word.length > 0);
            const wordsLeft = maxWords - words.length;
            wordsLeftDisplay.textContent = `Allowed number of words remaining: ${wordsLeft >= 0 ? wordsLeft : 0}`;
            if (words.length > maxWords) {
                textArea.value = words.slice(0, maxWords).join(' ');
                alert(`Word limit of ${maxWords} reached.`);
            }
        });
    
        // New script to send text to Flask and display detected language and POS tagged sentence
        document.querySelector('.detect-button').addEventListener('click', function() {
            const text = document.getElementById('text-area').value;
            
            // Send input to Flask using Fetch API
            fetch('/detect_language', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/x-www-form-urlencoded',
                },
                body: `text=${encodeURIComponent(text)}`
            })
            .then(response => response.json())
            .then(data => {
                if (data.predicted_language) {
                    document.getElementById('detected-language').innerText = `Detected language: ${data.predicted_language}`;
                    document.getElementById('pos-tagged-sentence').innerText = `POS Tagged Sentence: ${data.pos_tagged_sentence}`;
                } else {
                    document.getElementById('detected-language').innerText = 'Error detecting language';
                    document.getElementById('pos-tagged-sentence').innerText = '';
                }
            })
            .catch(error => {
                console.error('Error:', error);
                document.getElementById('detected-language').innerText = 'Error detecting language';
                document.getElementById('pos-tagged-sentence').innerText = '';
            });
        });
    </script>
</body>
</html>
